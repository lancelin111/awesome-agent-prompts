# 机器学习 Prompts

## 模型选择助手

```
请根据以下问题场景，推荐合适的机器学习模型：

【问题描述】
- 业务目标：[描述要解决的问题]
- 数据规模：[样本数量 x 特征数量]
- 目标变量：[连续/离散/多分类]
- 数据特点：[是否有缺失值、异常值、不平衡等]
- 性能要求：[准确性/速度/可解释性的优先级]
- 部署环境：[实时/批处理/边缘设备]

【请提供】
1. **推荐模型**
   - 首选模型及理由
   - 备选模型2-3个
   - 不适合的模型及原因

2. **模型对比**
   | 模型 | 优势 | 劣势 | 适用场景 | 超参数建议 |
   |------|------|------|----------|------------|

3. **实施建议**
   - 数据预处理要求
   - 特征工程建议
   - 训练策略
   - 评估指标选择
   - 过拟合预防措施

4. **代码模板**
   ```python
   # 提供sklearn/tensorflow/pytorch实现
   ```
```

## 特征工程专家

```
请为以下数据集设计特征工程方案：

【数据描述】
```python
# 示例数据结构
df.info()
df.describe()
df.head()
```

【业务背景】
[描述业务场景和预测目标]

【特征工程需求】

1. **数值特征处理**
   - 缺失值处理策略
   - 异常值处理方法
   - 标准化/归一化选择
   - 分箱策略（如需要）
   - 多项式特征
   - 对数/指数变换

2. **类别特征编码**
   - Label Encoding场景
   - One-Hot Encoding场景
   - Target Encoding方法
   - Embedding建议
   - 高基数类别处理

3. **时间特征提取**
   - 趋势特征
   - 周期性特征
   - 滞后特征
   - 滑动窗口统计
   - 节假日特征

4. **交互特征生成**
   - 特征组合建议
   - 比率特征
   - 差值特征
   - 统计聚合特征

5. **特征选择方法**
   - 过滤法（相关性、方差）
   - 包装法（RFE、前向选择）
   - 嵌入法（L1/L2、树模型）
   - 特征重要性排序

【输出代码】
```python
# 完整的特征工程pipeline
class FeatureEngineer:
    def __init__(self):
        pass
    
    def fit_transform(self, df):
        # 实现代码
        pass
```
```

## 模型调优专家

```
请帮我优化机器学习模型性能：

【当前模型】
- 算法：[模型名称]
- 当前性能：[指标和数值]
- 训练时间：[时长]
- 预测时间：[时长]

【数据情况】
- 训练集大小：[样本数]
- 特征数量：[特征数]
- 类别分布：[如果是分类问题]

【当前代码】
```python
[粘贴当前模型代码]
```

【优化目标】
- 主要指标：[准确率/召回率/F1/AUC等]
- 次要考虑：[训练速度/预测速度/模型大小]

【请提供】

1. **问题诊断**
   - 过拟合/欠拟合判断
   - 学习曲线分析
   - 错误案例分析

2. **超参数优化**
   ```python
   # Grid Search
   param_grid = {...}
   
   # Random Search
   param_distributions = {...}
   
   # Bayesian Optimization
   search_space = {...}
   
   # Optuna实现
   def objective(trial):
       ...
   ```

3. **集成学习策略**
   - Bagging方案
   - Boosting方案
   - Stacking方案
   - Voting策略

4. **其他优化技巧**
   - 样本权重调整
   - 阈值优化
   - 后处理策略
   - 模型压缩方法

5. **A/B测试方案**
   - 评估指标设计
   - 样本量计算
   - 显著性检验
```